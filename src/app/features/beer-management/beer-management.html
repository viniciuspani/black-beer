<p-toast></p-toast>
<p-confirmDialog [style]="{width: '30rem'}"></p-confirmDialog>

<p-card>
  <ng-template pTemplate="title">
    <div class="flex items-center justify-between">
      <div class="flex items-center gap-2">
        <i class="pi pi-database text-2xl"></i>
        <span>Gerenciar Tipos de Cerveja</span>
      </div>
      <p-button
        [icon]="isAdding() ? 'pi pi-times' : 'pi pi-plus'"
        [label]="isAdding() ? 'Cancelar' : 'Nova Cerveja'"
        [severity]="isAdding() ? 'secondary' : 'primary'"
        (onClick)="toggleAddForm()">
      </p-button>
    </div>
  </ng-template>

  <ng-template pTemplate="content">
    <div class="mb-6 border-2 border-gray-200 rounded-lg p-4">
      @if(isAdding()){
        <form [formGroup]="beerForm" (ngSubmit)="handleAddBeer()" class="flex flex-col gap-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="flex flex-col gap-2">
              <label for="name" class="font-semibold">Nome da Cerveja *</label>
              <input pInputText id="name" formControlName="name" />
            </div>
            <div class="flex flex-col gap-2">
              <label for="color" class="font-semibold">Cor da Cerveja</label>
              <p-colorPicker formControlName="color"></p-colorPicker>
            </div>
          </div>
          <div class="flex flex-col gap-2">
            <label for="description" class="font-semibold">Descrição</label>
            <textarea pInputTextarea id="description" formControlName="description" [rows]="2"></textarea>
          </div>
          <p-button type="submit" label="Salvar Cerveja" icon="pi pi-check" [disabled]="beerForm.invalid"></p-button>
        </form>
      }
    </div>

    <p-table [value]="beerTypes()" [tableStyle]="{'min-width': '50rem'}">
      <ng-template pTemplate="header">
        <tr>
          <th style="width: 5%">Cor</th>
          <th>Nome</th>
          <th>Descrição</th>
          <th style="width: 10%">Tipo</th>
          <th style="width: 10%">Ações</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-beer>
        <tr>
          <td>
            <div class="w-6 h-6 rounded-full border-2" [style.backgroundColor]="beer.color"></div>
          </td>
          <td>{{ beer.name }}</td>
          <td>{{ beer.description }}</td>
          <td>
            <p-tag [value]="isDefaultBeer(beer.id) ? 'Padrão' : 'Custom'"
                   [severity]="isDefaultBeer(beer.id) ? 'info' : 'success'">
            </p-tag>
          </td>
          <td>
            <p-button
              icon="pi pi-trash"
              severity="danger"
              [text]="true"
              [rounded]="true"
              (click)="confirmDelete(beer)"
              pTooltip="Remover Cerveja"
              tooltipPosition="top"
              [disabled]="isDefaultBeer(beer.id)">
            </p-button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="5" class="text-center p-4">Nenhum tipo de cerveja encontrado.</td>
        </tr>
      </ng-template>
    </p-table>

  </ng-template>
</p-card>
